import{c as k,i as T,g as z,e as A,r as i,j as e,d as j,m as F}from"./index-BeMRu7EZ.js";import{u as U}from"./useToast-Ck4PLXYN.js";import{d as o,u as E,e as L,f as P,h as I}from"./memeService-Cx0q3kK3.js";import{C as Y,f as _,a as v,T as B,S as H}from"./dateUtils-KRUWJFkm.js";import{T as V,M as q,E as O}from"./thumbs-up-iI90VcMK.js";import{S as R}from"./send-Des2sudS.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=k("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),$=()=>{const{id:r}=T(),d=z(),{isAuthenticated:m,user:x}=A(),{showToast:a}=U(),[s,l]=i.useState(null),[g,y]=i.useState(!0),[n,u]=i.useState(""),[h,f]=i.useState(!1),[b,p]=i.useState(!1);i.useEffect(()=>{(async()=>{try{if(!r)return;const c=await o(r);l(c)}catch{a("Failed to load meme","error"),d("/")}finally{y(!1)}})()},[r,d,a]);const N=async()=>{if(!m){a("You need to login to vote","info");return}try{if(!r)return;await E(r);const t=await o(r);l(t),a("Upvoted!","success")}catch{a("Failed to upvote","error")}},w=async()=>{if(!m){a("You need to login to vote","info");return}try{if(!r)return;await L(r);const t=await o(r);l(t),a("Downvoted!","success")}catch{a("Failed to downvote","error")}},M=()=>{navigator.share?navigator.share({title:(s==null?void 0:s.title)||"Check out this meme!",text:(s==null?void 0:s.description)||"Found this awesome meme on MemeHub",url:window.location.href}).catch(console.error):(navigator.clipboard.writeText(window.location.href),a("Link copied to clipboard!","success"))},S=async t=>{if(t.preventDefault(),!m){a("You need to login to comment","info");return}if(!n.trim()){a("Comment cannot be empty","warning");return}try{if(f(!0),!r)return;await P(r,n);const c=await o(r);l(c),u(""),a("Comment added!","success")}catch{a("Failed to add comment","error")}finally{f(!1)}},C=async()=>{if(window.confirm("Are you sure you want to delete this meme?"))try{if(p(!0),!r)return;await I(r),a("Meme deleted successfully","success"),d("/")}catch{a("Failed to delete meme","error"),p(!1)}};if(g)return e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(j,{size:"lg"})});if(!s)return e.jsxs("div",{className:"text-center py-10",children:[e.jsx("h2",{className:"text-xl font-medium",children:"Meme not found"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"This meme might have been deleted or doesn't exist."})]});const D=(x==null?void 0:x._id)===s.creator._id;return e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-base-100 rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-500 flex items-center justify-center text-white mr-3",children:s.creator.profilePicture?e.jsx("img",{src:s.creator.profilePicture,alt:s.creator.username,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("span",{className:"text-lg",children:s.creator.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-medium",children:s.creator.username}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Y,{size:14,className:"mr-1"}),e.jsx("time",{dateTime:s.createdAt,title:_(new Date(s.createdAt)),children:v(new Date(s.createdAt))})]})]})]}),D&&e.jsx("button",{onClick:C,disabled:b,className:"p-2 text-error-500 hover:bg-error-50 rounded-full transition-colors",title:"Delete meme",children:e.jsx(G,{size:20})})]}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:s.title}),s.description&&e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:s.tags.map(t=>e.jsxs("span",{className:"px-2 py-1 bg-base-300 rounded-full text-sm font-medium",children:["#",t]},t))})]}),e.jsx("div",{className:"relative",children:e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full object-contain max-h-[600px]"})}),e.jsx("div",{className:"p-6 border-t border-base-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:N,className:"p-2 rounded-full hover:bg-base-300 transition-colors",title:"Upvote",children:e.jsx(V,{size:20})}),e.jsx("span",{className:"font-medium",children:s.upvotes})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:w,className:"p-2 rounded-full hover:bg-base-300 transition-colors",title:"Downvote",children:e.jsx(B,{size:20})}),e.jsx("span",{className:"font-medium",children:s.downvotes})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{size:20}),e.jsxs("span",{children:[s.comments.length," comments"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{size:20}),e.jsxs("span",{children:[s.views," views"]})]})]}),e.jsx("button",{onClick:M,className:"p-2 rounded-full hover:bg-base-300 transition-colors",title:"Share",children:e.jsx(H,{size:20})})]})}),e.jsx("div",{className:"border-t border-base-300",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Comments"}),e.jsxs("form",{onSubmit:S,className:"mb-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:t=>u(t.target.value),placeholder:"Add a comment...",maxLength:140,className:"flex-1 px-4 py-2 rounded-md border border-base-300 focus:ring focus:ring-primary-200 focus:border-primary-500 focus:ring-opacity-50"}),e.jsx("button",{type:"submit",disabled:h||!n.trim(),className:"px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors disabled:opacity-50 flex items-center",children:h?e.jsx(j,{size:"sm",color:"text-white"}):e.jsxs(e.Fragment,{children:[e.jsx(R,{size:16,className:"mr-2"}),"Send"]})})]}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[140-n.length," characters remaining"]})]}),e.jsx("div",{className:"space-y-4",children:s.comments.length===0?e.jsx("p",{className:"text-center text-gray-500 py-4",children:"No comments yet. Be the first to comment!"}):s.comments.map(t=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center text-white shrink-0",children:t.user.profilePicture?e.jsx("img",{src:t.user.profilePicture,alt:t.user.username,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{children:t.user.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"font-medium",children:t.user.username}),e.jsx("span",{className:"text-sm text-gray-500",children:v(new Date(t.createdAt))})]}),e.jsx("p",{className:"mt-1",children:t.text})]})]},t._id))})]})})]})})};export{$ as default};
