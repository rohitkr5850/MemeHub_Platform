import{c as I,r as s,u as X,f as ie,a as ce,P as le,L as de,j as e,m as A,b as G,d as Q}from"./index-BeMRu7EZ.js";import{M as ue}from"./MemeCard-7Ff5hVNx.js";import{T as me,g as Z,a as fe}from"./memeService-Cx0q3kK3.js";import{u as he}from"./useToast-Ck4PLXYN.js";import{C as xe}from"./dateUtils-KRUWJFkm.js";import{T as pe}from"./trending-up-jKG5AXj7.js";import"./thumbs-up-iI90VcMK.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=I("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=I("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=I("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=I("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=I("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=I("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function ee(){const t=s.useRef(!1);return X(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function Ne(){const t=ee(),[o,r]=s.useState(0),a=s.useCallback(()=>{t.current&&r(o+1)},[o]);return[s.useCallback(()=>ie.postRender(a),[a]),o]}class Me extends s.Component{getSnapshotBeforeUpdate(o){const r=this.props.childRef.current;if(r&&o.isPresent&&!this.props.isPresent){const a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Se({children:t,isPresent:o}){const r=s.useId(),a=s.useRef(null),p=s.useRef({width:0,height:0,top:0,left:0});return s.useInsertionEffect(()=>{const{width:f,height:m,top:i,left:h}=p.current;if(o||!a.current||!f||!m)return;a.current.dataset.motionPopId=r;const x=document.createElement("style");return document.head.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${f}px !important;
            height: ${m}px !important;
            top: ${i}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(x)}},[o]),s.createElement(Me,{isPresent:o,childRef:a,sizeRef:p},s.cloneElement(t,{ref:a}))}const _=({children:t,initial:o,isPresent:r,onExitComplete:a,custom:p,presenceAffectsLayout:f,mode:m})=>{const i=ce(Ce),h=s.useId(),x=s.useMemo(()=>({id:h,initial:o,isPresent:r,custom:p,onExitComplete:c=>{i.set(c,!0);for(const d of i.values())if(!d)return;a&&a()},register:c=>(i.set(c,!1),()=>i.delete(c))}),f?void 0:[r]);return s.useMemo(()=>{i.forEach((c,d)=>i.set(d,!1))},[r]),s.useEffect(()=>{!r&&!i.size&&a&&a()},[r]),m==="popLayout"&&(t=s.createElement(Se,{isPresent:r},t)),s.createElement(le.Provider,{value:x},t)};function Ce(){return new Map}function Re(t){return s.useEffect(()=>()=>t(),[])}const T=t=>t.key||"";function ke(t,o){t.forEach(r=>{const a=T(r);o.set(a,r)})}function Ee(t){const o=[];return s.Children.forEach(t,r=>{s.isValidElement(r)&&o.push(r)}),o}const Te=({children:t,custom:o,initial:r=!0,onExitComplete:a,exitBeforeEnter:p,presenceAffectsLayout:f=!0,mode:m="sync"})=>{const i=s.useContext(de).forceRender||Ne()[0],h=ee(),x=Ee(t);let c=x;const d=s.useRef(new Map).current,C=s.useRef(c),g=s.useRef(new Map).current,w=s.useRef(!0);if(X(()=>{w.current=!1,ke(x,g),C.current=c}),Re(()=>{w.current=!0,g.clear(),d.clear()}),w.current)return s.createElement(s.Fragment,null,c.map(u=>s.createElement(_,{key:T(u),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:f,mode:m},u)));c=[...c];const v=C.current.map(T),j=x.map(T),R=v.length;for(let u=0;u<R;u++){const l=v[u];j.indexOf(l)===-1&&!d.has(l)&&d.set(l,void 0)}return m==="wait"&&d.size&&(c=[]),d.forEach((u,l)=>{if(j.indexOf(l)!==-1)return;const N=g.get(l);if(!N)return;const M=v.indexOf(l);let k=u;if(!k){const S=()=>{d.delete(l);const L=Array.from(g.keys()).filter(y=>!j.includes(y));if(L.forEach(y=>g.delete(y)),C.current=x.filter(y=>{const F=T(y);return F===l||L.includes(F)}),!d.size){if(h.current===!1)return;i(),a&&a()}};k=s.createElement(_,{key:T(N),isPresent:!1,onExitComplete:S,custom:o,presenceAffectsLayout:f,mode:m},N),d.set(l,k)}c.splice(M,0,k)}),c=c.map(u=>{const l=u.key;return d.has(l)?u:s.createElement(_,{key:T(u),isPresent:!0,presenceAffectsLayout:f,mode:m},u)}),s.createElement(s.Fragment,null,d.size?c:c.map(u=>s.cloneElement(u)))};var H=new Map,P=new WeakMap,Y=0,ze=void 0;function Ie(t){return t?(P.has(t)||(Y+=1,P.set(t,Y.toString())),P.get(t)):"0"}function Le(t){return Object.keys(t).sort().filter(o=>t[o]!==void 0).map(o=>`${o}_${o==="root"?Ie(t.root):t[o]}`).toString()}function Fe(t){const o=Le(t);let r=H.get(o);if(!r){const a=new Map;let p;const f=new IntersectionObserver(m=>{m.forEach(i=>{var h;const x=i.isIntersecting&&p.some(c=>i.intersectionRatio>=c);t.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=x),(h=a.get(i.target))==null||h.forEach(c=>{c(x,i)})})},t);p=f.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),r={id:o,observer:f,elements:a},H.set(o,r)}return r}function $e(t,o,r={},a=ze){if(typeof window.IntersectionObserver>"u"&&a!==void 0){const h=t.getBoundingClientRect();return o(a,{isIntersecting:a,target:t,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:h,intersectionRect:h,rootBounds:h}),()=>{}}const{id:p,observer:f,elements:m}=Fe(r),i=m.get(t)||[];return m.has(t)||m.set(t,i),i.push(o),f.observe(t),function(){i.splice(i.indexOf(o),1),i.length===0&&(m.delete(t),f.unobserve(t)),m.size===0&&(f.disconnect(),H.delete(p))}}function Pe({threshold:t,delay:o,trackVisibility:r,rootMargin:a,root:p,triggerOnce:f,skip:m,initialInView:i,fallbackInView:h,onChange:x}={}){var c;const[d,C]=s.useState(null),g=s.useRef(x),[w,v]=s.useState({inView:!!i,entry:void 0});g.current=x,s.useEffect(()=>{if(m||!d)return;let l;return l=$e(d,(N,M)=>{v({inView:N,entry:M}),g.current&&g.current(N,M),M.isIntersecting&&f&&l&&(l(),l=void 0)},{root:p,rootMargin:a,threshold:t,trackVisibility:r,delay:o},h),()=>{l&&l()}},[Array.isArray(t)?t.toString():t,d,p,a,f,m,r,h,o]);const j=(c=w.entry)==null?void 0:c.target,R=s.useRef(void 0);!d&&j&&!f&&!m&&R.current!==j&&(R.current=j,v({inView:!!i,entry:void 0}));const u=[C,w.inView,w.entry];return u.ref=u[0],u.inView=u[1],u.entry=u[2],u}const Oe=[{value:"new",label:"Newest",icon:e.jsx(xe,{size:16})},{value:"top",label:"Top",icon:e.jsx(pe,{size:16})},{value:"hot",label:"Hot",icon:e.jsx(ve,{size:16})}],Ue=()=>{const{showToast:t}=he(),[o,r]=s.useState([]),[a,p]=s.useState(!0),[f,m]=s.useState(!1),[i,h]=s.useState(1),[x,c]=s.useState(!0),[d,C]=s.useState("new"),[g,w]=s.useState("all"),[v,j]=s.useState(void 0),[R,u]=s.useState([]),[l,N]=s.useState(""),[M,k]=s.useState(!1),[S,L]=s.useState([]),[y,F]=s.useState(!1),[$,K]=s.useState("list"),{ref:te,inView:D}=Pe({threshold:.5,triggerOnce:!1}),O=s.useRef(null),z=async(n=!1)=>{try{const b=n?1:i;if(n?p(!0):m(!0),y){const E=JSON.parse(localStorage.getItem("savedMemes")||"[]"),V=await Z(1,100,d,g,v,l,E);r(V.memes),c(!1),h(1)}else{const E=await Z(b,10,d,g,v,l);r(n?E.memes:V=>[...V,...E.memes]),c(E.hasMore),h(b+1)}}catch{t("Failed to load memes","error")}finally{p(!1),m(!1),k(!1)}},U=async()=>{try{const n=await fe(10);u(n)}catch(n){console.error("Failed to load trending tags",n)}};s.useEffect(()=>{const n=JSON.parse(localStorage.getItem("savedMemes")||"[]");L(n),z(!0),U()},[d,g,v,l,y]),s.useEffect(()=>{D&&x&&!a&&!f&&W()},[D]);const W=()=>{!f&&x&&z()},se=n=>{d!==n&&(C(n),h(1))},ne=n=>{g!==n&&(w(n),h(1))},q=n=>{j(n),h(1)},re=n=>{n.preventDefault(),z(!0)},oe=()=>{k(!0),z(!0),U()},J=()=>{F(!y)},ae=n=>{let b;S.includes(n)?(b=S.filter(E=>E!==n),t("Meme removed from saved","info")):(b=[...S,n],t("Meme saved successfully","success")),L(b),localStorage.setItem("savedMemes",JSON.stringify(b)),y&&z(!0)},B=n=>{var b;n.key==="/"&&document.activeElement!==O.current&&(n.preventDefault(),(b=O.current)==null||b.focus())};return s.useEffect(()=>(document.addEventListener("keydown",B),()=>{document.removeEventListener("keydown",B)}),[]),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 pb-10",onKeyDown:B,children:[e.jsxs(A.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[e.jsxs("div",{className:"inline-flex items-center mb-2",children:[e.jsx(G,{className:"h-8 w-8 mr-2 text-primary-500"}),e.jsx("h1",{className:"text-3xl font-display font-bold",children:"MemeHub"})]}),e.jsx("p",{className:"text-lg",children:"The Internet's Playground for Memes"})]}),e.jsxs("div",{className:"mb-6 bg-base-100 rounded-lg p-4 shadow-md",children:[e.jsx("form",{onSubmit:re,className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(we,{size:18,className:"text-gray-400"})}),e.jsx("input",{ref:O,type:"text",placeholder:"Search memes... (Press '/' to focus)",value:l,onChange:n=>N(n.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),l&&e.jsx("button",{type:"button",onClick:()=>N(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("span",{className:"text-gray-400 hover:text-gray-600",children:"×"})})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-between items-center mb-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:Oe.map(n=>e.jsxs("button",{onClick:()=>se(n.value),className:`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${d===n.value?"bg-primary-500 text-white":"hover:bg-base-300"}`,children:[e.jsx("span",{className:"mr-1",children:n.icon}),n.label]},n.value))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:oe,className:"flex items-center px-3 py-2 rounded-md text-sm font-medium hover:bg-base-300 transition-colors",disabled:M,children:[e.jsx(be,{size:16,className:`mr-1 ${M?"animate-spin":""}`}),"Refresh"]}),e.jsxs("button",{onClick:J,className:`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${y?"bg-accent-500 text-white":"hover:bg-base-300"}`,children:[e.jsx(ge,{size:16,className:"mr-1"}),y?"All Memes":"Saved",!y&&S.length>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-primary-500 text-white text-xs rounded-full",children:S.length})]}),e.jsxs("div",{className:"flex rounded-md overflow-hidden border border-gray-300",children:[e.jsx("button",{onClick:()=>K("list"),className:`px-2 py-1 ${$==="list"?"bg-gray-200":"bg-white"}`,title:"List view",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),e.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]})}),e.jsx("button",{onClick:()=>K("grid"),className:`px-2 py-1 ${$==="grid"?"bg-gray-200":"bg-white"}`,title:"Grid view",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})})]})]})]}),d==="top"&&e.jsx("div",{className:"flex space-x-2 w-full overflow-x-auto pb-2 mb-4",children:me.map(n=>e.jsx("button",{onClick:()=>ne(n.value),className:`px-3 py-1.5 rounded-md text-sm font-medium whitespace-nowrap transition-colors ${g===n.value?"bg-secondary-500 text-white":"hover:bg-base-300"}`,children:n.label},n.value))}),R.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(ye,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Trending Tags:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[v&&e.jsx("button",{onClick:()=>q(void 0),className:"px-2 py-1 bg-base-300 hover:bg-base-200 rounded-full text-xs font-medium transition-colors",children:"Clear Filter"}),R.map(n=>e.jsxs("button",{onClick:()=>q(n.tag),className:`px-2 py-1 rounded-full text-xs font-medium transition-colors ${v===n.tag?"bg-accent-500 text-white":"bg-base-300 hover:bg-base-200"}`,children:["#",n.tag," ",e.jsxs("span",{className:"opacity-70",children:["(",n.count,")"]})]},n.tag))]})]})]}),a?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Q,{size:"lg"})}):o.length===0?e.jsxs("div",{className:"text-center py-10 bg-base-100 rounded-lg shadow-md",children:[e.jsx(G,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:"No memes found"}),e.jsx("p",{className:"text-gray-500",children:y?"You haven't saved any memes yet":v?`No memes found with the tag #${v}`:l?`No results found for "${l}"`:"Be the first to create a meme!"}),y&&e.jsx("button",{onClick:J,className:"mt-4 px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors",children:"Browse All Memes"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:$==="grid"?"grid grid-cols-1 sm:grid-cols-2 gap-6":"space-y-6",children:e.jsx(Te,{children:o.map((n,b)=>e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{delay:b*.05},children:e.jsx(ue,{meme:n,onVote:z,isSaved:S.includes(n._id),onToggleSave:()=>ae(n._id),compact:$==="grid"})},n._id))})}),x&&e.jsx("div",{ref:te,className:"flex justify-center mt-6 py-4",children:f?e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{size:"sm",color:"text-primary-500"}),e.jsx("span",{className:"ml-2",children:"Loading more memes..."})]}):e.jsx("button",{onClick:W,className:"px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors",children:"Load More Memes"})})]}),e.jsx(A.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed bottom-6 right-6 p-3 bg-primary-500 text-white rounded-full shadow-lg hover:bg-primary-600 transition-colors",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(je,{size:20})})]})};export{Ue as default};
