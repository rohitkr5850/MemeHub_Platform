import{c as j,n as S,A as k,e as L,r as b,j as e,m as z,U as y,d as A}from"./index-BeMRu7EZ.js";import{u as F}from"./index.esm-BChO6BRn.js";import{u as C}from"./useToast-Ck4PLXYN.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=j("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=j("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),q=async s=>{try{return(await S.put(`${k}/api/users/me`,s)).data}catch(i){throw console.error("Error updating profile:",i),i}},M=()=>{var x,g;const{user:s,checkAuth:i}=L(),{showToast:u}=C(),[d,p]=b.useState(!1),[f,v]=b.useState((s==null?void 0:s.profilePicture)||null),{register:m,handleSubmit:w,watch:h,formState:{errors:r}}=F({defaultValues:{username:(s==null?void 0:s.username)||"",bio:(s==null?void 0:s.bio)||""}});h("profilePicture");const N=a=>{var l;const o=(l=a.target.files)==null?void 0:l[0];if(o){const t=new FileReader;t.onloadend=()=>{v(t.result)},t.readAsDataURL(o)}},P=async a=>{var o,l,t;try{p(!0);let c;if((o=a.profilePicture)!=null&&o[0]){const n=new FileReader;c=await new Promise(U=>{n.onloadend=()=>U(n.result),n.readAsDataURL(a.profilePicture[0])})}await q({username:a.username,bio:a.bio,profilePicture:c}),await i(),u("Profile updated successfully!","success")}catch(c){const n=((t=(l=c.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update profile";u(n,"error")}finally{p(!1)}};return e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-base-100 rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(y,{className:"w-6 h-6 mr-2 text-primary-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Profile"})]}),e.jsxs("form",{onSubmit:w(P),className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-full bg-base-300 overflow-hidden",children:f?e.jsx("img",{src:f,alt:"Profile preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-4xl text-gray-400",children:(x=s==null?void 0:s.username)==null?void 0:x.charAt(0).toUpperCase()})}),e.jsx("label",{htmlFor:"profilePicture",className:"absolute bottom-0 right-0 p-2 bg-primary-500 rounded-full text-white cursor-pointer hover:bg-primary-600 transition-colors",children:e.jsx(I,{size:20})}),e.jsx("input",{id:"profilePicture",type:"file",...m("profilePicture"),onChange:N,accept:"image/*",className:"hidden"})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Click the camera icon to upload a new profile picture"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium mb-1",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(y,{size:18,className:"text-gray-400"})}),e.jsx("input",{id:"username",type:"text",...m("username",{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"},maxLength:{value:20,message:"Username must be less than 20 characters"},pattern:{value:/^[a-zA-Z0-9_]+$/,message:"Username can only contain letters, numbers, and underscores"}}),className:`w-full pl-10 pr-3 py-2 rounded-md border focus:ring focus:ring-opacity-50 focus:outline-none ${r.username?"border-error-500 focus:ring-error-200":"border-gray-300 focus:ring-primary-200 focus:border-primary-500"}`})]}),r.username&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.username.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium mb-1",children:"Bio"}),e.jsx("textarea",{id:"bio",...m("bio",{maxLength:{value:160,message:"Bio must be less than 160 characters"}}),rows:4,className:`w-full px-3 py-2 rounded-md border focus:ring focus:ring-opacity-50 focus:outline-none ${r.bio?"border-error-500 focus:ring-error-200":"border-gray-300 focus:ring-primary-200 focus:border-primary-500"}`,placeholder:"Tell us about yourself..."}),r.bio&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.bio.message}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[160-(((g=h("bio"))==null?void 0:g.length)||0)," characters remaining"]})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full bg-primary-500 text-white py-2 rounded-md hover:bg-primary-600 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 flex items-center justify-center",children:d?e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{size:"sm",color:"text-white"}),e.jsx("span",{className:"ml-2",children:"Updating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{size:18,className:"mr-2"}),"Save Changes"]})})]})]})})};export{M as default};
