import{e as p,r as d,j as s,m as f,h as j}from"./index-BeMRu7EZ.js";import{u as v}from"./useToast-Ck4PLXYN.js";import{u as g,e as b}from"./memeService-Cx0q3kK3.js";import{C as N,a as w,T as y,S as k}from"./dateUtils-KRUWJFkm.js";import{T as C,M as T,E as D}from"./thumbs-up-iI90VcMK.js";const _=({meme:e,onVote:i})=>{const{isAuthenticated:n}=p(),{showToast:r}=v(),[l,o]=d.useState(!1),[x,c]=d.useState(e.upvotes-e.downvotes),u=async t=>{if(t.preventDefault(),t.stopPropagation(),!n){r("You need to login to vote on memes","info");return}if(!l){o(!0);try{await g(e._id),c(a=>a+1),i&&i()}catch{r("You already voted on this meme","error")}finally{o(!1)}}},h=async t=>{if(t.preventDefault(),t.stopPropagation(),!n){r("You need to login to vote on memes","info");return}if(!l){o(!0);try{await b(e._id),c(a=>a-1),i&&i()}catch{r("You already voted on this meme","error")}finally{o(!1)}}},m=t=>{if(t.preventDefault(),t.stopPropagation(),navigator.share)navigator.share({title:e.title,text:e.description||"Check out this meme on MemeHub!",url:`/meme/${e._id}`}).catch(a=>{console.error("Error sharing:",a)});else{const a=`${window.location.origin}/meme/${e._id}`;navigator.clipboard.writeText(a),r("Link copied to clipboard!","success")}};return s.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-base-100 rounded-lg shadow-md overflow-hidden",children:s.jsxs(j,{to:`/meme/${e._id}`,className:"block",children:[s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center mb-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center text-white mr-2",children:e.creator.profilePicture?s.jsx("img",{src:e.creator.profilePicture,alt:e.creator.username,className:"w-8 h-8 rounded-full object-cover"}):s.jsx("span",{children:e.creator.username.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:e.creator.username}),s.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[s.jsx(N,{size:12,className:"mr-1"}),s.jsx("span",{children:w(new Date(e.createdAt))})]})]})]}),s.jsx("h3",{className:"font-medium text-lg mb-2",children:e.title}),e.description&&s.jsx("p",{className:"text-sm mb-3 text-gray-600",children:e.description})]}),s.jsx("div",{className:"relative",children:s.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full object-cover",style:{maxHeight:"500px"}})}),s.jsxs("div",{className:"p-4",children:[e.tags.length>0&&s.jsx("div",{className:"mb-3 flex flex-wrap gap-1",children:e.tags.map(t=>s.jsxs("span",{className:"inline-block px-2 py-1 bg-base-300 rounded-full text-xs font-medium",children:["#",t]},t))}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:u,className:"p-1.5 rounded-full hover:bg-base-300 transition-colors",children:s.jsx(C,{size:18})}),s.jsx("span",{className:"text-sm font-medium",children:x}),s.jsx("button",{onClick:h,className:"p-1.5 rounded-full hover:bg-base-300 transition-colors",children:s.jsx(y,{size:18})})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(T,{size:18}),s.jsx("span",{className:"text-sm",children:e.comments.length})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(D,{size:18}),s.jsx("span",{className:"text-sm",children:e.views})]})]}),s.jsx("button",{onClick:m,className:"p-1.5 rounded-full hover:bg-base-300 transition-colors",children:s.jsx(k,{size:18})})]})]})]})})};export{_ as M};
